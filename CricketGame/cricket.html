<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cricket</title>
    <style>
      body {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <h1>Bat Ball Stump Game</h1>
    <button
      onclick="
     let computerChoice = generateComputerChoice()
    let resultMsg = getResult('Bat' , computerChoice);
    ShowResult('Bat',computerChoice,resultMsg);
  "
    >
      Bat
    </button>
    <button
      onclick="
    computerChoice = generateComputerChoice()
   // console.log(computerChoice);
   // resultMsg;
   resultMsg = getResult('Ball' , computerChoice);
   ShowResult('Ball',computerChoice,resultMsg);
"
    >
      Ball
    </button>
    <button
      onclick="
   computerChoice = generateComputerChoice()
   resultMsg = getResult('Stump' , computerChoice);
    //resultMsg;
    ShowResult('Stump',computerChoice,resultMsg);
   "
    >
      Stump
    </button>
    <button onclick="localStorage.clear()
    resetScore();">RESET</button>
   <!-- srif localstorage.clear likhne se storage clean hojaega par memory me score set rhega to vo same previous score hi show karega  aur srif yha pe score nhi update karna display function ko bhi update karna hai-->
    <script>
      //let computerChoice;
      let scoreStr = localStorage.getItem('Score');
      let score;
     resetScore(scoreStr);
      // if(scoreStr !== undefined){
      //   score = JSON.parse(scoreStr);

      // } else {
      //   score = {
      //   win: 0,
      //   loss: 0,
      //   tie: 0,
        
      // };
      // } 
      function resetScore(scoreStr){
         score  = scoreStr ? JSON.parse(scoreStr) : {
        win: 0,
        loss: 0,
         tie: 0,
      };
      
      score.displayScore = function () {
          return `
           win : ${score.win}
           loss : ${score.loss}
           tie : ${score.tie}`;
        };
      }
      
      function generateComputerChoice() {
        let randomNumber = Math.random() * 3;

        if (randomNumber > 0 && randomNumber <= 1) {
          return "Bat";
        } else if (randomNumber <= 2) {
          return "Ball";
        } else {
          return "Stump";
        }
      }

      function getResult(userMove, computerMove) {
        if (userMove == "Bat") {
          if (computerMove === "Ball") {
            score.win++;
            return "User won.";
          } else if (computerMove === "Bat") {
            score.tie++;
            return `It's a tie`;
          } else if (computerMove === "Stump") {
            score.loss++;
            return "Computer has won";
          }
        } else if (userMove == "Ball") {
          if (computerMove === "Ball") {
            score.tie++;
            return `It's a tie`;
          } else if (computerMove === "Bat") {
            score.loss++;
            return "Computer has won";
          } else if (computerMove === "Stump") {
            score.win++;
            return "User has won";
          }
        } else {
          if (computerMove === "Ball") {
            score.loss++;
            return `Computer has won`;
          } else if (computerMove === "Bat") {
            score.win++;
            return "User has won";
          } else if (computerMove === "Stump") {
            score.tie++;
            return `It's a tie`;
          }
        }
      }

      function ShowResult(userMove, computerMove, result) {
        // console.log(score);
        localStorage.setItem('Score',JSON.stringify(score));
        alert(
          ` You have chosen ${userMove}. Computer choice is ${computerMove} and 
          ${result}
          ${score.displayScore()}
          `
        );
      }
    </script>
  </body>
</html>
